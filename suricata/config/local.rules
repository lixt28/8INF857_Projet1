# 1000005 – HTTP exploit basique (GET ...?exploit=1)
alert http any any -> $HOME_NET 80 (
  msg:"HTTP_EXPLOIT_ATTEMPT";
  flow:established,to_server;
  http.uri; content:"exploit=1";
  classtype:web-application-attack; sid:1000005; rev:2;
)

# 1000006 – SSH brute force (rafales SYN vers 22/TCP)
# NOTE: pas de "established" car on détecte des SYN
alert tcp any any -> $HOME_NET 22 (
  msg:"SSH_BRUTEFORCE_ATTEMPT";
  flags:S; flow:to_server;
  detection_filter:track by_src, count 20, seconds 60;
  classtype:attempted-admin; sid:1000006; rev:3;
)

# 1000007 – Port scan (SYN scan) vers plusieurs ports
alert tcp any any -> $HOME_NET any (
  msg:"PORTSCAN_SYN";
  flags:S; flow:stateless;
  detection_filter:track by_src, count 50, seconds 60;
  classtype:attempted-recon; sid:1000007; rev:2;
)

# 1000008 – DNS exfil (payload "exfil" vers 53/UDP)
alert udp any any -> $HOME_NET 53 (
  msg:"DNS_EXFIL_SUSPECT";
  content:"exfil"; nocase; depth:64;
  classtype:data-theft; sid:1000008; rev:2;
)

# 1000009 – ICMP ping flood (echo request)
alert icmp any any -> $HOME_NET any (
  msg:"ICMP_FLOOD_ATTEMPT";
  itype:8;
  detection_filter:track by_src, count 10, seconds 10;
  classtype:attempted-dos; sid:1000009; rev:2;
)
